(()=>{let createElement=(e,t,r="")=>{if(null==t)return`<${e}>${r}</${e}>`;{let a="";return Object.keys(t).forEach(e=>{a+=`${e}="${t[e]}"`}),`<${e} ${a}>${r}</${e}>`}},placeholders=(template,data,attribute)=>{"use strict";if(-1===["string","number"].indexOf(typeof(template="function"==typeof template?template():template)))throw"WADE DOM : please provide a valid template!";return data?template=template.replace(/\{\{([^}]+)\}\}/g,function(match){if(match=match.slice(2,-2),attribute=RegExp(`${attribute}\\.`,"g"),!match.match(attribute))return data;var sub=(match=match.replace(attribute,"")).split(".");if(sub.length>1){var temp=data;return sub.forEach(function(e){var e=e.trim();if(!temp[e]){temp="{{"+match.trim()+"}}";return}temp=temp[e]}),eval(`data.${match.trim()}`)}return match.match(/\[.*\]/g)?eval(`data.${match.trim()}`):data[match.trim()]?data[match.trim()]:"{{"+match.trim()+"}}"}):template};return customElements.define("wade-import",class extends HTMLElement{connectedCallback(){this.outerHTML=`<iframe style="display:none;" src="${this.getAttribute("src")}" onload="wade.createComponent(this);this.remove();"></iframe>`}}),customElements.define("wade-head",class extends HTMLElement{connectedCallback(){this.outerHTML=this.innerHTML}}),customElements.define("wade-app",class extends HTMLElement{connectedCallback(){let e=navigator.language||navigator.userLanguage;e.match(this.getAttribute("lang"))?(document.querySelector("html").lang=e,this.outerHTML=this.innerHTML):this.outerHTML=""}}),customElements.define("wade-for",class extends HTMLElement{connectedCallback(){let e=Function(`return ${this.getAttribute("data")}`)(),t="",r=this.innerHTML;e.forEach(e=>{t+=placeholders(r,e,this.getAttribute("in"))}),this.outerHTML=t}}),customElements.define("wade-routes",class extends HTMLElement{connectedCallback(){this.outerHTML=`<div class="wade-routes">${this.innerHTML}</div>`}}),customElements.define("wade-route",class extends HTMLElement{connectedCallback(){window.location.pathname==this.getAttribute("path")?this.outerHTML=this.innerHTML:this.outerHTML="",document.querySelectorAll('.wade-router[href^="/"]').forEach(e=>e.addEventListener("click",e=>{e.preventDefault();let{pathname:t}=new URL(e.target.href);window.history.pushState({path:t},t,t),document.querySelector(".wade-routes").innerHTML=this.innerHTML}))}}),customElements.define("wade-link",class extends HTMLElement{connectedCallback(){let e={class:"wade-router",href:this.getAttribute("href")};this.getAttributeNames().forEach(t=>{t.match(/href/g)||(e[t]?e[t]+=` ${this.getAttribute(t)}`:e[t]=`${this.getAttribute(t)}`)}),this.outerHTML=createElement("a",e,this.innerHTML)}}),{createComponent(e){e.contentDocument.querySelectorAll("template").forEach(e=>{customElements.define(e.getAttribute("name"),class extends HTMLElement{connectedCallback(){this.outerHTML=createElement("div",{id:"app",class:e.getAttribute("name")})}}),document.querySelectorAll(`div#app.${e.getAttribute("name")}`).forEach(t=>{t.attachShadow({mode:"open"}),t.shadowRoot.innerHTML=e.innerHTML})})}}})();
